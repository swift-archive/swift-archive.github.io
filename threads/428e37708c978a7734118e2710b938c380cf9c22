<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/f921fa5d507b31ef6984fd3d77ae710c?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Brian Gesiak</string> &lt;modocache at gmail.com&gt;<p>January 28, 2016 at 12:00:00pm</p></header><div class="content"><p>Hello all!<br></p><p>I&#39;m encountering a build failure when compiling the stdlib, using the tip<br>of master as of this morning (d44d6e). I&#39;m running Ubuntu 15.10 on a x86_64<br>machine.<br></p><p>Here are my build logs:<br>https://gist.github.com/modocache/a85851a53b570d5fca47. The logs show that<br>I remove my build directory completely, before starting a clean build with<br>`utils/build-script -R`.<br></p><p>I was surprised to see a build failure, so I tried a bisect to narrow down<br>what may have caused it. Here&#39;s the log from the bisect, which I made<br>between master (d44d6e) and a known good commit (061c77):<br>https://gist.github.com/modocache/89c347a3c50767eee7eb<br></p><p>The bisect points to commit 638e4b, &quot;IRGen/Runtime: Use relative addresses<br>in nominal type descriptors&quot;. But I&#39;m skeptical: that commit is weeks old,<br>and was even included in swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a. I very<br>much doubt it introduced a build failure.<br></p><p>I tried building swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a, and even *that*<br>doesn&#39;t build on my system!! I assume this snapshot has passed CI, so I<br>thought there must be something wrong with my system. But William Dillion<br>tells me he&#39;s experiencing the same error (<br>https://twitter.com/hpux735/status/692758868670058496).<br></p><p>William and I are both working on armv7 ports, so perhaps both of our build<br>machines are similarly broken. But I&#39;m curious if anyone has any ideas on<br>what the problem might be, or if this build error reproduces for anyone<br>else building on Linux. Thoughts?<br></p><p>- Brian Gesiak<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160128/428e9c22/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>January 28, 2016 at 10:00:00am</p></header><div class="content"><p>Hi, Brian. This required an update to LLVM as well, which Lang Hames should have cherry-picked to the stable branch. Are your LLVM and Clang fully up to date?<br></p><p>Jordan<br></p><p>&gt; On Jan 28, 2016, at 9:44 , Brian Gesiak via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; Hello all!<br>&gt; <br>&gt; I&#39;m encountering a build failure when compiling the stdlib, using the tip of master as of this morning (d44d6e). I&#39;m running Ubuntu 15.10 on a x86_64 machine.<br>&gt; <br>&gt; Here are my build logs: https://gist.github.com/modocache/a85851a53b570d5fca47 &lt;https://gist.github.com/modocache/a85851a53b570d5fca47&gt;. The logs show that I remove my build directory completely, before starting a clean build with `utils/build-script -R`.<br>&gt; <br>&gt; I was surprised to see a build failure, so I tried a bisect to narrow down what may have caused it. Here&#39;s the log from the bisect, which I made between master (d44d6e) and a known good commit (061c77): https://gist.github.com/modocache/89c347a3c50767eee7eb &lt;https://gist.github.com/modocache/89c347a3c50767eee7eb&gt;<br>&gt; <br>&gt; The bisect points to commit 638e4b, &quot;IRGen/Runtime: Use relative addresses in nominal type descriptors&quot;. But I&#39;m skeptical: that commit is weeks old, and was even included in swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a. I very much doubt it introduced a build failure.<br>&gt; <br>&gt; I tried building swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a, and even *that* doesn&#39;t build on my system!! I assume this snapshot has passed CI, so I thought there must be something wrong with my system. But William Dillion tells me he&#39;s experiencing the same error (https://twitter.com/hpux735/status/692758868670058496 &lt;https://twitter.com/hpux735/status/692758868670058496&gt;).<br>&gt; <br>&gt; William and I are both working on armv7 ports, so perhaps both of our build machines are similarly broken. But I&#39;m curious if anyone has any ideas on what the problem might be, or if this build error reproduces for anyone else building on Linux. Thoughts?<br>&gt; <br>&gt; - Brian Gesiak<br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160128/a343f15c/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/f921fa5d507b31ef6984fd3d77ae710c?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Brian Gesiak</string> &lt;modocache at gmail.com&gt;<p>January 28, 2016 at 01:00:00pm</p></header><div class="content"><p>Thanks, Jordan!<br></p><p>I had thought they were, since I recall running `utils/update-checkout`<br>soon after encountering the error. I just tried a `git pull --rebase origin<br>stable` from within my `llvm` directory, though, and that pulled in 249898<br>&quot;[RuntimeDyld] Fix a class of arithmetic errors introduced in r253918&quot;.<br>Sounds very relevant to my problem! :)<br></p><p>I&#39;m building again now after pulling in the changes--if you don&#39;t hear from<br>me assume that everything works now. Thanks again for your help!<br></p><p>- Brian Gesiak<br></p><p><br>On Thu, Jan 28, 2016 at 1:09 PM, Jordan Rose &lt;jordan_rose at apple.com&gt; wrote:<br></p><p>&gt; Hi, Brian. This required an update to LLVM as well, which Lang Hames<br>&gt; should have cherry-picked to the stable branch. Are your LLVM and Clang<br>&gt; fully up to date?<br>&gt;<br>&gt; Jordan<br>&gt;<br>&gt; On Jan 28, 2016, at 9:44 , Brian Gesiak via swift-dev &lt;swift-dev at swift.org&gt;<br>&gt; wrote:<br>&gt;<br>&gt; Hello all!<br>&gt;<br>&gt; I&#39;m encountering a build failure when compiling the stdlib, using the tip<br>&gt; of master as of this morning (d44d6e). I&#39;m running Ubuntu 15.10 on a x86_64<br>&gt; machine.<br>&gt;<br>&gt; Here are my build logs:<br>&gt; https://gist.github.com/modocache/a85851a53b570d5fca47. The logs show<br>&gt; that I remove my build directory completely, before starting a clean build<br>&gt; with `utils/build-script -R`.<br>&gt;<br>&gt; I was surprised to see a build failure, so I tried a bisect to narrow down<br>&gt; what may have caused it. Here&#39;s the log from the bisect, which I made<br>&gt; between master (d44d6e) and a known good commit (061c77):<br>&gt; https://gist.github.com/modocache/89c347a3c50767eee7eb<br>&gt;<br>&gt; The bisect points to commit 638e4b, &quot;IRGen/Runtime: Use relative addresses<br>&gt; in nominal type descriptors&quot;. But I&#39;m skeptical: that commit is weeks old,<br>&gt; and was even included in swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a. I very<br>&gt; much doubt it introduced a build failure.<br>&gt;<br>&gt; I tried building swift-DEVELOPMENT-SNAPSHOT-2016-01-25-a, and even *that*<br>&gt; doesn&#39;t build on my system!! I assume this snapshot has passed CI, so I<br>&gt; thought there must be something wrong with my system. But William Dillion<br>&gt; tells me he&#39;s experiencing the same error (<br>&gt; https://twitter.com/hpux735/status/692758868670058496).<br>&gt;<br>&gt; William and I are both working on armv7 ports, so perhaps both of our<br>&gt; build machines are similarly broken. But I&#39;m curious if anyone has any<br>&gt; ideas on what the problem might be, or if this build error reproduces for<br>&gt; anyone else building on Linux. Thoughts?<br>&gt;<br>&gt; - Brian Gesiak<br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br>&gt;<br>&gt;<br>&gt;<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160128/4a79cce1/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/969b04d28c02f951ccc03f615b9a92b3?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Dmitri Gribenko</string> &lt;gribozavr at gmail.com&gt;<p>January 28, 2016 at 10:00:00am</p></header><div class="content"><p>On Thu, Jan 28, 2016 at 10:28 AM, Brian Gesiak via swift-dev<br>&lt;swift-dev at swift.org&gt; wrote:<br>&gt; Thanks, Jordan!<br>&gt;<br>&gt; I had thought they were, since I recall running `utils/update-checkout` soon<br>&gt; after encountering the error.<br></p><p>Did you do `update-checkout -a` ?  The default option set only updates swift.<br></p><p>Dmitri<br></p><p>-- <br>main(i,j){for(i=2;;i++){for(j=2;j&lt;i;j++){if(!(i%j)){j=0;break;}}if<br>(j){printf(&quot;%d\n&quot;,i);}}} /*Dmitri Gribenko &lt;gribozavr at gmail.com&gt;*/<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>January 28, 2016 at 10:00:00am</p></header><div class="content"><p>&gt; On Jan 28, 2016, at 10:31, Dmitri Gribenko &lt;gribozavr at gmail.com&gt; wrote:<br>&gt; <br>&gt; On Thu, Jan 28, 2016 at 10:28 AM, Brian Gesiak via swift-dev<br>&gt; &lt;swift-dev at swift.org&gt; wrote:<br>&gt;&gt; Thanks, Jordan!<br>&gt;&gt; <br>&gt;&gt; I had thought they were, since I recall running `utils/update-checkout` soon<br>&gt;&gt; after encountering the error.<br>&gt; <br>&gt; Did you do `update-checkout -a` ?  The default option set only updates swift.<br></p><p>This probably predates having a stable branch for LLVM and Clang; maybe we should just remove it.<br></p><p>Jordan<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/969b04d28c02f951ccc03f615b9a92b3?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Dmitri Gribenko</string> &lt;gribozavr at gmail.com&gt;<p>January 28, 2016 at 10:00:00am</p></header><div class="content"><p>On Thu, Jan 28, 2016 at 10:32 AM, Jordan Rose &lt;jordan_rose at apple.com&gt; wrote:<br>&gt;<br>&gt;&gt; On Jan 28, 2016, at 10:31, Dmitri Gribenko &lt;gribozavr at gmail.com&gt; wrote:<br>&gt;&gt;<br>&gt;&gt; On Thu, Jan 28, 2016 at 10:28 AM, Brian Gesiak via swift-dev<br>&gt;&gt; &lt;swift-dev at swift.org&gt; wrote:<br>&gt;&gt;&gt; Thanks, Jordan!<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; I had thought they were, since I recall running `utils/update-checkout` soon<br>&gt;&gt;&gt; after encountering the error.<br>&gt;&gt;<br>&gt;&gt; Did you do `update-checkout -a` ?  The default option set only updates swift.<br>&gt;<br>&gt; This probably predates having a stable branch for LLVM and Clang; maybe we should just remove it.<br></p><p>Well, updating all repositories serially as we do it now takes quite<br>some time.  If we could do it in parallel...<br></p><p>Dmitri<br></p><p>-- <br>main(i,j){for(i=2;;i++){for(j=2;j&lt;i;j++){if(!(i%j)){j=0;break;}}if<br>(j){printf(&quot;%d\n&quot;,i);}}} /*Dmitri Gribenko &lt;gribozavr at gmail.com&gt;*/<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>Build failure? &quot;LLVM ERROR: Cannot represent a subtraction with a weak symbol&quot;</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>January 28, 2016 at 10:00:00am</p></header><div class="content"><p>&gt; On Jan 28, 2016, at 10:34, Dmitri Gribenko &lt;gribozavr at gmail.com&gt; wrote:<br>&gt; <br>&gt; On Thu, Jan 28, 2016 at 10:32 AM, Jordan Rose &lt;jordan_rose at apple.com&gt; wrote:<br>&gt;&gt; <br>&gt;&gt;&gt; On Jan 28, 2016, at 10:31, Dmitri Gribenko &lt;gribozavr at gmail.com&gt; wrote:<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; On Thu, Jan 28, 2016 at 10:28 AM, Brian Gesiak via swift-dev<br>&gt;&gt;&gt; &lt;swift-dev at swift.org&gt; wrote:<br>&gt;&gt;&gt;&gt; Thanks, Jordan!<br>&gt;&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; I had thought they were, since I recall running `utils/update-checkout` soon<br>&gt;&gt;&gt;&gt; after encountering the error.<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Did you do `update-checkout -a` ?  The default option set only updates swift.<br>&gt;&gt; <br>&gt;&gt; This probably predates having a stable branch for LLVM and Clang; maybe we should just remove it.<br>&gt; <br>&gt; Well, updating all repositories serially as we do it now takes quite<br>&gt; some time.  If we could do it in parallel...<br></p><p>I always assumed the limiting factor was the network. If that&#39;s not the case, then sure!<br></p><p>Jordan<br></p></div></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
