<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css?vsn=d">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg?vsn=d" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>swiftCore dependencies on Foundation</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>October  4, 2016 at 10:00:00am</p></header><div class="content"><p>In HuonW’s recent pull request &lt;https://github.com/apple/swift/pull/4814&gt; we hit an unusual error &lt;https://ci.swift.org/job/swift-PR-osx/3922/&gt;:<br></p><p>&gt; 2016-10-03 12:34:08.112 swift[56714:13650955] *** Terminating app due to uncaught exception &#39;NSInvalidArgumentException&#39;, reason: &#39;*** -length only defined for abstract class.  Define -[_TtCs19_NSContiguousString length]!&#39;<br>&gt; *** First throw call stack:<br>&gt; (<br>&gt; 	0   CoreFoundation                      0x00007fff9cbe64f2 __exceptionPreprocess + 178<br>&gt; 	1   libobjc.A.dylib                     0x00007fff9daaa73c objc_exception_throw + 48<br>&gt; 	2   CoreFoundation                      0x00007fff9cc4d4bd +[NSException raise:format:] + 205<br>&gt; 	3   Foundation                          0x00007fff943e8dbd NSRequestConcreteImplementation + 229<br>&gt; 	4   Foundation                          0x00007fff9442588a -[NSString length] + 19<br>&gt; 	5   CoreFoundation                      0x00007fff9cc2b613 CFStringHashNSString + 51<br>&gt; 	6   libswiftCore.dylib                  0x0000000114f7ef56 _TTSfq4s___TFSSg9hashValueSi + 118<br>&gt; 	7   libswiftCore.dylib                  0x0000000114f3b96b _TTWSSs8HashablesFS_g9hashValueSi + 43<br>&gt; 	8   libswiftCore.dylib                  0x0000000114e8f0a2 _TFVs24_NativeDictionaryStorage7_bucketfxSi + 34<br></p><p>We’re not really sure how this could happen, though. _NSContiguousString certainly does implement -length &lt;https://github.com/apple/swift/blob/master/stdlib/public/core/StringBridge.swift#L221&gt;, and even though there’s an outstanding PR &lt;https://github.com/apple/swift/pull/5071&gt; to change it to a property that shouldn’t cause this kind of issue. (It’s not marked @objc, but it shouldn’t need to be because the superclass is &lt;https://github.com/apple/swift/blob/master/stdlib/public/core/StringBridge.swift#L184-L191&gt;.)<br></p><p>Anyone know what’s going on here?<br></p><p>Jordan<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20161004/7766a5e3/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/06c1dcc7dce6a93d194b9c013376e3f0?s=50"></div><header><strong>swiftCore dependencies on Foundation</strong> from <string>Joe Groff</string> &lt;jgroff at apple.com&gt;<p>October  4, 2016 at 12:00:00pm</p></header><div class="content"><p>&gt; On Oct 4, 2016, at 10:11 AM, Jordan Rose via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; In HuonW’s recent pull request &lt;https://github.com/apple/swift/pull/4814&gt; we hit an unusual error &lt;https://ci.swift.org/job/swift-PR-osx/3922/&gt;:<br>&gt; <br>&gt;&gt; 2016-10-03 12:34:08.112 swift[56714:13650955] *** Terminating app due to uncaught exception &#39;NSInvalidArgumentException&#39;, reason: &#39;*** -length only defined for abstract class.  Define -[_TtCs19_NSContiguousString length]!&#39;<br>&gt;&gt; *** First throw call stack:<br>&gt;&gt; (<br>&gt;&gt; 	0   CoreFoundation                      0x00007fff9cbe64f2 __exceptionPreprocess + 178<br>&gt;&gt; 	1   libobjc.A.dylib                     0x00007fff9daaa73c objc_exception_throw + 48<br>&gt;&gt; 	2   CoreFoundation                      0x00007fff9cc4d4bd +[NSException raise:format:] + 205<br>&gt;&gt; 	3   Foundation                          0x00007fff943e8dbd NSRequestConcreteImplementation + 229<br>&gt;&gt; 	4   Foundation                          0x00007fff9442588a -[NSString length] + 19<br>&gt;&gt; 	5   CoreFoundation                      0x00007fff9cc2b613 CFStringHashNSString + 51<br>&gt;&gt; 	6   libswiftCore.dylib                  0x0000000114f7ef56 _TTSfq4s___TFSSg9hashValueSi + 118<br>&gt;&gt; 	7   libswiftCore.dylib                  0x0000000114f3b96b _TTWSSs8HashablesFS_g9hashValueSi + 43<br>&gt;&gt; 	8   libswiftCore.dylib                  0x0000000114e8f0a2 _TFVs24_NativeDictionaryStorage7_bucketfxSi + 34<br>&gt; <br>&gt; We’re not really sure how this could happen, though. _NSContiguousString certainly does implement -length &lt;https://github.com/apple/swift/blob/master/stdlib/public/core/StringBridge.swift#L221&gt;, and even though there’s an outstanding PR &lt;https://github.com/apple/swift/pull/5071&gt; to change it to a property that shouldn’t cause this kind of issue. (It’s not marked @objc, but it shouldn’t need to be because the superclass is &lt;https://github.com/apple/swift/blob/master/stdlib/public/core/StringBridge.swift#L184-L191&gt;.)<br>&gt; <br>&gt; Anyone know what’s going on here?<br></p><p>I didn&#39;t see any obvious reason it would, but since this patch messes with IRGen it would be good to double-check that we still emit ObjC class metadata with the correct format. This seems like the kind of problem that could arise if we ended up generating the method tables incorrectly for some reason.<br></p><p>-Joe<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20161004/9d8d627f/attachment.html&gt;<br></p></div></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js?vsn=d"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
