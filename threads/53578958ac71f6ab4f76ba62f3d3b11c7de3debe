<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/e2303da56647c283b6d8e58d5831faca?s=50"></div><header><strong>ASan runtime does not come first</strong> from <string>Joseph Bell</string> &lt;joe at iachieved.it&gt;<p>April 24, 2016 at 04:00:00pm</p></header><div class="content"><p>Well, I thought the REPL issues had all been put to rest, but now I am<br>seeing this on Ubuntu 14.04 (15.10 I do not see it):<br></p><p>➜  package-swift-3.0 git:(swift-3.0) ✗ ./install/usr/bin/swift<br>==18928==ASan runtime does not come first in initial library list; you<br>should either link runtime to your application or manually preload it with<br>LD_PRELOAD.<br></p><p>This is with the &quot;master&quot; branches that build Swift 3.0, hashes:<br></p><p>$ swift swiftrevs.swift<br>swift:95e3be665d<br>llvm:752e1430fc<br>clang:1e6cba3ce3<br>lldb:a38bed5855<br>compiler-rt:a897309947<br>cmark:5af77f3c1d<br>llbuild:ea9fd78a4a<br>swiftpm:22954afe9f<br>swift-corelibs-xctest:efdde9849c<br>swift-corelibs-foundation:d2dc9f3cf9<br>swift-integration-tests:98f6c6d992<br>swift-corelibs-libdispatch:65330e06d9<br></p><p>Is anyone else building the world on Ubuntu 14.04 that can verify this?<br>Regards,<br>Joe<br></p><p>-- <br>Joseph Bell<br>http://dev.iachieved.it/iachievedit/<br>@iachievedit<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160424/5357debe/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/14477c366d6ee4e41adf14837bc4f2f9?s=50"></div><header><strong>ASan runtime does not come first</strong> from <string>Ryan Lovelett</string> &lt;swift-dev at ryan.lovelett.me&gt;<p>April 25, 2016 at 08:00:00am</p></header><div class="content"><p>On Sun, Apr 24, 2016, at 05:44 PM, Joseph Bell via swift-dev wrote:<br>&gt; Well, I thought the REPL issues had all been put to rest, but now I am<br>&gt; seeing this on Ubuntu 14.04 (15.10 I do not see it):<br>&gt;<br>&gt; ➜  package-swift-3.0 git:(swift-3.0) ✗ ./install/usr/bin/swift<br>&gt; ==18928==ASan runtime does not come first in initial library list; you<br>&gt; ==should either link runtime to your application or manually preload<br>&gt; ==it with LD_PRELOAD.<br>&gt;<br>&gt; This is with the &quot;master&quot; branches that build Swift 3.0, hashes:<br>&gt;<br>&gt; $ swift swiftrevs.swift<br>&gt; swift:95e3be665d<br>&gt; llvm:752e1430fc<br>&gt; clang:1e6cba3ce3<br>&gt; lldb:a38bed5855<br>&gt; compiler-rt:a897309947<br>&gt; cmark:5af77f3c1d<br>&gt; llbuild:ea9fd78a4a<br>&gt; swiftpm:22954afe9f<br>&gt; swift-corelibs-xctest:efdde9849c<br>&gt; swift-corelibs-foundation:d2dc9f3cf9<br>&gt; swift-integration-tests:98f6c6d992<br>&gt; swift-corelibs-libdispatch:65330e06d9<br>&gt;<br>&gt; Is anyone else building the world on Ubuntu 14.04 that can<br>&gt; verify this?<br> <br>I have seen this behavior many times in many scenarios. Almost always it<br>has to do with a build parameter.<br> <br>Recently I have noticed that compiling with the &quot;compiler-rt&quot; project<br>seems to cause this issue frequently. I do not understand what &quot;compiler-<br>rt&quot; is, or what its value to Swift is, so I just omit it from my builds.<br>It maybe worth while to do the same and rebuild and see if it goes away.<br> <br>I would think that if &quot;compiler-rt&quot; is the source of the issues then<br>something likely needs to be submitted to bugs.swift.org.<br> <br>Another thing to check is if your packaging Swift (dep, rpm, pacman,<br>etc...) that you are do not strip symbols from binaries and libraries as<br>part of packaging.<br> <br>&gt; Regards,<br>&gt; Joe<br>&gt;<br>&gt; --<br>&gt; Joseph Bell<br>&gt; http://dev.iachieved.it/iachievedit/<br>&gt; @iachievedit<br>&gt; _________________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br> <br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160425/5a7fe153/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/e2303da56647c283b6d8e58d5831faca?s=50"></div><header><strong>ASan runtime does not come first</strong> from <string>Joseph Bell</string> &lt;joe at iachieved.it&gt;<p>April 25, 2016 at 08:00:00am</p></header><div class="content"><p>I&#39;ve just noticed (thanks to you Ryan) that compiler-rt is indeed checked<br>out and included in the 14.04 build but not the 15.10.  I&#39;m going to<br>rebuild from the ground up on 15.10 to see if it grabs compiler-rt and<br>reproduces, as this is being checked out by the ci.swift.org CI server.<br></p><p>This error occurs before any downstream packaging (deb) and is failing the<br>build itself (on the test REPL, it can&#39;t even load).  Will report back in a<br>bit.<br></p><p>Joe<br></p><p><br>On Mon, Apr 25, 2016 at 7:52 AM, Ryan Lovelett &lt;swift-dev at ryan.lovelett.me&gt;<br>wrote:<br></p><p>&gt; On Sun, Apr 24, 2016, at 05:44 PM, Joseph Bell via swift-dev wrote:<br>&gt;<br>&gt; Well, I thought the REPL issues had all been put to rest, but now I am<br>&gt; seeing this on Ubuntu 14.04 (15.10 I do not see it):<br>&gt;<br>&gt; ➜  package-swift-3.0 git:(swift-3.0) ✗ ./install/usr/bin/swift<br>&gt; ==18928==ASan runtime does not come first in initial library list; you<br>&gt; should either link runtime to your application or manually preload it with<br>&gt; LD_PRELOAD.<br>&gt;<br>&gt; This is with the &quot;master&quot; branches that build Swift 3.0, hashes:<br>&gt;<br>&gt; $ swift swiftrevs.swift<br>&gt; swift:95e3be665d<br>&gt; llvm:752e1430fc<br>&gt; clang:1e6cba3ce3<br>&gt; lldb:a38bed5855<br>&gt; compiler-rt:a897309947<br>&gt; cmark:5af77f3c1d<br>&gt; llbuild:ea9fd78a4a<br>&gt; swiftpm:22954afe9f<br>&gt; swift-corelibs-xctest:efdde9849c<br>&gt; swift-corelibs-foundation:d2dc9f3cf9<br>&gt; swift-integration-tests:98f6c6d992<br>&gt; swift-corelibs-libdispatch:65330e06d9<br>&gt;<br>&gt; Is anyone else building the world on Ubuntu 14.04 that can verify this?<br>&gt;<br>&gt;<br>&gt; I have seen this behavior many times in many scenarios. Almost always it<br>&gt; has to do with a build parameter.<br>&gt;<br>&gt; Recently I have noticed that compiling with the &quot;compiler-rt&quot; project<br>&gt; seems to cause this issue frequently. I do not understand what<br>&gt; &quot;compiler-rt&quot; is, or what its value to Swift is, so I just omit it from my<br>&gt; builds. It maybe worth while to do the same and rebuild and see if it goes<br>&gt; away.<br>&gt;<br>&gt; I would think that if &quot;compiler-rt&quot; is the source of the issues then<br>&gt; something likely needs to be submitted to bugs.swift.org.<br>&gt;<br>&gt; Another thing to check is if your packaging Swift (dep, rpm, pacman,<br>&gt; etc...) that you are do not strip symbols from binaries and libraries as<br>&gt; part of packaging.<br>&gt;<br>&gt;<br>&gt; Regards,<br>&gt; Joe<br>&gt;<br>&gt; --<br>&gt; Joseph Bell<br>&gt; http://dev.iachieved.it/iachievedit/<br>&gt; @iachievedit<br>&gt; *_______________________________________________*<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br>&gt;<br>&gt;<br>&gt;<br></p><p><br></p><p>-- <br>Joseph Bell<br>http://dev.iachieved.it/iachievedit/<br>@iachievedit<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160425/cdadd270/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/e2303da56647c283b6d8e58d5831faca?s=50"></div><header><strong>ASan runtime does not come first</strong> from <string>Joseph Bell</string> &lt;joe at iachieved.it&gt;<p>April 25, 2016 at 01:00:00pm</p></header><div class="content"><p>What I&#39;ve found out so far is that the tree built in the &#39;install&#39;<br>directory (./install/usr) is not suitable to live side-by-side with /usr/<br>on the host machine.  My original approach (documented on<br>http://dev.iachieved.it/iachievedit/) was to ball everything up into a .deb<br>package that installed as an overlay to /usr/, this was just to make it<br>simple to get started.<br></p><p>Now with swift-2.2 and swift-3.0 and the possibility one might want to use<br>both (python2.7, python3), I&#39;m going to change over to placing in<br>/opt/swift/VERSION and provide some alternatives mechanism, OR, use the<br>approach that python2.7, 3, etc. use where there is a /usr/bin/python2.7/,<br>/usr/lib/python2.7/, etc. and /usr/bin/python links back there.<br></p><p>tl;dr:  I don&#39;t know what occurs exactly but the equivalent of rsync -a<br>./install/usr/ /usr/ (overlay) causes mayhem for starting the REPL.<br></p><p>On Mon, Apr 25, 2016 at 8:02 AM, Joseph Bell &lt;joe at iachieved.it&gt; wrote:<br></p><p>&gt; I&#39;ve just noticed (thanks to you Ryan) that compiler-rt is indeed checked<br>&gt; out and included in the 14.04 build but not the 15.10.  I&#39;m going to<br>&gt; rebuild from the ground up on 15.10 to see if it grabs compiler-rt and<br>&gt; reproduces, as this is being checked out by the ci.swift.org CI server.<br>&gt;<br>&gt; This error occurs before any downstream packaging (deb) and is failing the<br>&gt; build itself (on the test REPL, it can&#39;t even load).  Will report back in a<br>&gt; bit.<br>&gt;<br>&gt; Joe<br>&gt;<br>&gt;<br>&gt; On Mon, Apr 25, 2016 at 7:52 AM, Ryan Lovelett &lt;swift-dev at ryan.lovelett.me<br>&gt; &gt; wrote:<br>&gt;<br>&gt;&gt; On Sun, Apr 24, 2016, at 05:44 PM, Joseph Bell via swift-dev wrote:<br>&gt;&gt;<br>&gt;&gt; Well, I thought the REPL issues had all been put to rest, but now I am<br>&gt;&gt; seeing this on Ubuntu 14.04 (15.10 I do not see it):<br>&gt;&gt;<br>&gt;&gt; ➜  package-swift-3.0 git:(swift-3.0) ✗ ./install/usr/bin/swift<br>&gt;&gt; ==18928==ASan runtime does not come first in initial library list; you<br>&gt;&gt; should either link runtime to your application or manually preload it with<br>&gt;&gt; LD_PRELOAD.<br>&gt;&gt;<br>&gt;&gt; This is with the &quot;master&quot; branches that build Swift 3.0, hashes:<br>&gt;&gt;<br>&gt;&gt; $ swift swiftrevs.swift<br>&gt;&gt; swift:95e3be665d<br>&gt;&gt; llvm:752e1430fc<br>&gt;&gt; clang:1e6cba3ce3<br>&gt;&gt; lldb:a38bed5855<br>&gt;&gt; compiler-rt:a897309947<br>&gt;&gt; cmark:5af77f3c1d<br>&gt;&gt; llbuild:ea9fd78a4a<br>&gt;&gt; swiftpm:22954afe9f<br>&gt;&gt; swift-corelibs-xctest:efdde9849c<br>&gt;&gt; swift-corelibs-foundation:d2dc9f3cf9<br>&gt;&gt; swift-integration-tests:98f6c6d992<br>&gt;&gt; swift-corelibs-libdispatch:65330e06d9<br>&gt;&gt;<br>&gt;&gt; Is anyone else building the world on Ubuntu 14.04 that can verify this?<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; I have seen this behavior many times in many scenarios. Almost always it<br>&gt;&gt; has to do with a build parameter.<br>&gt;&gt;<br>&gt;&gt; Recently I have noticed that compiling with the &quot;compiler-rt&quot; project<br>&gt;&gt; seems to cause this issue frequently. I do not understand what<br>&gt;&gt; &quot;compiler-rt&quot; is, or what its value to Swift is, so I just omit it from my<br>&gt;&gt; builds. It maybe worth while to do the same and rebuild and see if it goes<br>&gt;&gt; away.<br>&gt;&gt;<br>&gt;&gt; I would think that if &quot;compiler-rt&quot; is the source of the issues then<br>&gt;&gt; something likely needs to be submitted to bugs.swift.org.<br>&gt;&gt;<br>&gt;&gt; Another thing to check is if your packaging Swift (dep, rpm, pacman,<br>&gt;&gt; etc...) that you are do not strip symbols from binaries and libraries as<br>&gt;&gt; part of packaging.<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; Regards,<br>&gt;&gt; Joe<br>&gt;&gt;<br>&gt;&gt; --<br>&gt;&gt; Joseph Bell<br>&gt;&gt; http://dev.iachieved.it/iachievedit/<br>&gt;&gt; @iachievedit<br>&gt;&gt; *_______________________________________________*<br>&gt;&gt; swift-dev mailing list<br>&gt;&gt; swift-dev at swift.org<br>&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt;<br>&gt;<br>&gt;<br>&gt;<br>&gt; --<br>&gt; Joseph Bell<br>&gt; http://dev.iachieved.it/iachievedit/<br>&gt; @iachievedit<br>&gt;<br></p><p><br></p><p>-- <br>Joseph Bell<br>http://dev.iachieved.it/iachievedit/<br>@iachievedit<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160425/69bdc49a/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/d631f09a3a336a15ae258e01899cb736?s=50"></div><header><strong>ASan runtime does not come first</strong> from <string>Kate Stone</string> &lt;k8stone at apple.com&gt;<p>April 25, 2016 at 05:00:00pm</p></header><div class="content"><p>Indeed the install location proves to be the root issue.  When LLDB is installed in /usr/bin/lldb we also wind up with content under /usr/lib/lldb that are presumed to be plugins – even though they aren&#39;t.  When an ASAN enabled library is loaded to initialize the plugin it notices LLDB isn&#39;t running with the ASAN runtime and immediately terminates it.<br></p><p>Workarounds: don&#39;t install Swift packages in the root directory, or install and then rename /usr/lib/lldb to /usr/lib/lldb-disabled.<br></p><p>A fix for this is being tracked as &lt;rdar://problem/25921276&gt;<br></p><p>Kate Stone k8stone at apple.com &lt;mailto:k8stone at apple.com&gt;<br> Xcode Low Level Tools<br></p><p>&gt; On Apr 25, 2016, at 11:43 AM, Joseph Bell via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; What I&#39;ve found out so far is that the tree built in the &#39;install&#39; directory (./install/usr) is not suitable to live side-by-side with /usr/ on the host machine.  My original approach (documented on http://dev.iachieved.it/iachievedit/ &lt;http://dev.iachieved.it/iachievedit/&gt;) was to ball everything up into a .deb package that installed as an overlay to /usr/, this was just to make it simple to get started.<br>&gt; <br>&gt; Now with swift-2.2 and swift-3.0 and the possibility one might want to use both (python2.7, python3), I&#39;m going to change over to placing in /opt/swift/VERSION and provide some alternatives mechanism, OR, use the approach that python2.7, 3, etc. use where there is a /usr/bin/python2.7/, /usr/lib/python2.7/, etc. and /usr/bin/python links back there.  <br>&gt; <br>&gt; tl;dr:  I don&#39;t know what occurs exactly but the equivalent of rsync -a ./install/usr/ /usr/ (overlay) causes mayhem for starting the REPL.<br>&gt; <br>&gt; On Mon, Apr 25, 2016 at 8:02 AM, Joseph Bell &lt;joe at iachieved.it &lt;mailto:joe at iachieved.it&gt;&gt; wrote:<br>&gt; I&#39;ve just noticed (thanks to you Ryan) that compiler-rt is indeed checked out and included in the 14.04 build but not the 15.10.  I&#39;m going to rebuild from the ground up on 15.10 to see if it grabs compiler-rt and reproduces, as this is being checked out by the ci.swift.org &lt;http://ci.swift.org/&gt; CI server.<br>&gt; <br>&gt; This error occurs before any downstream packaging (deb) and is failing the build itself (on the test REPL, it can&#39;t even load).  Will report back in a bit.<br>&gt; <br>&gt; Joe<br>&gt; <br>&gt; <br>&gt; On Mon, Apr 25, 2016 at 7:52 AM, Ryan Lovelett &lt;swift-dev at ryan.lovelett.me &lt;mailto:swift-dev at ryan.lovelett.me&gt;&gt; wrote:<br>&gt; On Sun, Apr 24, 2016, at 05:44 PM, Joseph Bell via swift-dev wrote:<br>&gt;&gt; Well, I thought the REPL issues had all been put to rest, but now I am seeing this on Ubuntu 14.04 (15.10 I do not see it):<br>&gt;&gt;  <br>&gt;&gt; ➜  package-swift-3.0 git:(swift-3.0) ✗ ./install/usr/bin/swift<br>&gt;&gt; ==18928==ASan runtime does not come first in initial library list; you should either link runtime to your application or manually preload it with LD_PRELOAD.<br>&gt;&gt;  <br>&gt;&gt; This is with the &quot;master&quot; branches that build Swift 3.0, hashes:<br>&gt;&gt;  <br>&gt;&gt; $ swift swiftrevs.swift<br>&gt;&gt; swift:95e3be665d<br>&gt;&gt; llvm:752e1430fc<br>&gt;&gt; clang:1e6cba3ce3<br>&gt;&gt; lldb:a38bed5855<br>&gt;&gt; compiler-rt:a897309947<br>&gt;&gt; cmark:5af77f3c1d<br>&gt;&gt; llbuild:ea9fd78a4a<br>&gt;&gt; swiftpm:22954afe9f<br>&gt;&gt; swift-corelibs-xctest:efdde9849c<br>&gt;&gt; swift-corelibs-foundation:d2dc9f3cf9<br>&gt;&gt; swift-integration-tests:98f6c6d992<br>&gt;&gt; swift-corelibs-libdispatch:65330e06d9<br>&gt;&gt;  <br>&gt;&gt; Is anyone else building the world on Ubuntu 14.04 that can verify this?<br>&gt;  <br>&gt; I have seen this behavior many times in many scenarios. Almost always it has to do with a build parameter.<br>&gt;  <br>&gt; Recently I have noticed that compiling with the &quot;compiler-rt&quot; project seems to cause this issue frequently. I do not understand what &quot;compiler-rt&quot; is, or what its value to Swift is, so I just omit it from my builds. It maybe worth while to do the same and rebuild and see if it goes away.<br>&gt;  <br>&gt; I would think that if &quot;compiler-rt&quot; is the source of the issues then something likely needs to be submitted to bugs.swift.org &lt;http://bugs.swift.org/&gt;.<br>&gt;  <br>&gt; Another thing to check is if your packaging Swift (dep, rpm, pacman, etc...) that you are do not strip symbols from binaries and libraries as part of packaging.<br>&gt;  <br>&gt;&gt; Regards,<br>&gt;&gt; Joe<br>&gt;&gt;  <br>&gt;&gt; -- <br>&gt;&gt; Joseph Bell<br>&gt;&gt; http://dev.iachieved.it/iachievedit/ &lt;http://dev.iachieved.it/iachievedit/&gt;<br>&gt;&gt; @iachievedit<br>&gt;&gt; _______________________________________________<br>&gt;&gt; swift-dev mailing list<br>&gt;&gt; swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;<br>&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev &lt;https://lists.swift.org/mailman/listinfo/swift-dev&gt;<br>&gt;  <br>&gt; <br>&gt; <br>&gt; <br>&gt; -- <br>&gt; Joseph Bell<br>&gt; http://dev.iachieved.it/iachievedit/ &lt;http://dev.iachieved.it/iachievedit/&gt;<br>&gt; @iachievedit<br>&gt; <br>&gt; <br>&gt; <br>&gt; -- <br>&gt; Joseph Bell<br>&gt; http://dev.iachieved.it/iachievedit/ &lt;http://dev.iachieved.it/iachievedit/&gt;<br>&gt; @iachievedit<br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160425/55b34091/attachment.html&gt;<br></p></div></li></ul></li></ul></li></ul></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
