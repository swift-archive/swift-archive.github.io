<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/569ed436467cf145f3bbdd0d53fbe115?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Slava Pestov</string> &lt;spestov at apple.com&gt;<p>September  9, 2016 at 02:00:00pm</p></header><div class="content"><p>Hi all,<br></p><p>Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br></p><p>/Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>// OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>        ^<br>&lt;stdin&gt;:329:34: note: scanning from here<br> %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>                                 ^<br>&lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br> %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>                                 ^<br>&lt;stdin&gt;:330:2: note: possible intended match here<br> %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br> ^<br>/Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>// OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>        ^<br>&lt;stdin&gt;:1625:67: note: scanning from here<br>sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>                                                                  ^<br>/Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>// OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>        ^<br>&lt;stdin&gt;:1842:88: note: scanning from here<br>sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>                                                                                       ^<br>/Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>// OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>        ^<br>&lt;stdin&gt;:2059:95: note: scanning from here<br>sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>                                                                                              ^<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/86e6ad3f/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/ecb50a99bf3b4cc0249312945dce7115?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Ben Langmuir</string> &lt;blangmuir at apple.com&gt;<p>September  9, 2016 at 02:00:00pm</p></header><div class="content"><p>I saw this once on Tuesday.  I haven’t seen it since then.<br></p><p>&gt; On Sep 9, 2016, at 2:45 PM, Slava Pestov via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; Hi all,<br>&gt; <br>&gt; Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br>&gt; <br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:329:34: note: scanning from here<br>&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;                                  ^<br>&gt; &lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br>&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;                                  ^<br>&gt; &lt;stdin&gt;:330:2: note: possible intended match here<br>&gt;  %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br>&gt;  ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:1625:67: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                   ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:1842:88: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                                        ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:2059:95: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                                               ^<br>&gt; <br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/0dc9a4d0/attachment.html&gt;<br></p></div></li><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/8e77369a540cf4d35924683e176c7a9c?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Mark Lacey</string> &lt;mark.lacey at apple.com&gt;<p>September  9, 2016 at 02:00:00pm</p></header><div class="content"><p>&gt; On Sep 9, 2016, at 2:45 PM, Slava Pestov via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; Hi all,<br>&gt; <br>&gt; Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br></p><p>Yes, I hit this a couple days ago and attempted to reproduce and couldn’t.<br></p><p>Mark<br></p><p>&gt; <br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:329:34: note: scanning from here<br>&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;                                  ^<br>&gt; &lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br>&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;                                  ^<br>&gt; &lt;stdin&gt;:330:2: note: possible intended match here<br>&gt;  %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br>&gt;  ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:1625:67: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                   ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:1842:88: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                                        ^<br>&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;         ^<br>&gt; &lt;stdin&gt;:2059:95: note: scanning from here<br>&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;                                                                                               ^<br>&gt; <br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/be723862/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/569ed436467cf145f3bbdd0d53fbe115?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Slava Pestov</string> &lt;spestov at apple.com&gt;<p>September  9, 2016 at 02:00:00pm</p></header><div class="content"><p>Running it in a loop on another machine doesn’t trigger it, so I’m thinking it might be a random variation in how the standard library is built?<br></p><p>&gt; On Sep 9, 2016, at 2:49 PM, Mark Lacey &lt;mark.lacey at apple.com&gt; wrote:<br>&gt; <br>&gt; <br>&gt;&gt; On Sep 9, 2016, at 2:45 PM, Slava Pestov via swift-dev &lt;swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;&gt; wrote:<br>&gt;&gt; <br>&gt;&gt; Hi all,<br>&gt;&gt; <br>&gt;&gt; Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br>&gt; <br>&gt; Yes, I hit this a couple days ago and attempted to reproduce and couldn’t.<br>&gt; <br>&gt; Mark<br>&gt; <br>&gt;&gt; <br>&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>&gt;&gt;         ^<br>&gt;&gt; &lt;stdin&gt;:329:34: note: scanning from here<br>&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;                                  ^<br>&gt;&gt; &lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br>&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;                                  ^<br>&gt;&gt; &lt;stdin&gt;:330:2: note: possible intended match here<br>&gt;&gt;  %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br>&gt;&gt;  ^<br>&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;         ^<br>&gt;&gt; &lt;stdin&gt;:1625:67: note: scanning from here<br>&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;                                                                   ^<br>&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;         ^<br>&gt;&gt; &lt;stdin&gt;:1842:88: note: scanning from here<br>&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;                                                                                        ^<br>&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;         ^<br>&gt;&gt; &lt;stdin&gt;:2059:95: note: scanning from here<br>&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;                                                                                               ^<br>&gt;&gt; <br>&gt;&gt; _______________________________________________<br>&gt;&gt; swift-dev mailing list<br>&gt;&gt; swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;<br>&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br>&gt; <br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/206eaef7/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>September  9, 2016 at 05:00:00pm</p></header><div class="content"><p>Dmitri tracked it down and has a fix for it, and then I had a complaint about his fix, and then I didn&#39;t get back to it. :-)<br></p><p>https://github.com/apple/swift/pull/4622<br></p><p>Jordan<br></p><p><br>&gt; On Sep 9, 2016, at 14:50, Slava Pestov via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; Running it in a loop on another machine doesn’t trigger it, so I’m thinking it might be a random variation in how the standard library is built?<br>&gt; <br>&gt;&gt; On Sep 9, 2016, at 2:49 PM, Mark Lacey &lt;mark.lacey at apple.com &lt;mailto:mark.lacey at apple.com&gt;&gt; wrote:<br>&gt;&gt; <br>&gt;&gt; <br>&gt;&gt;&gt; On Sep 9, 2016, at 2:45 PM, Slava Pestov via swift-dev &lt;swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;&gt; wrote:<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Hi all,<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br>&gt;&gt; <br>&gt;&gt; Yes, I hit this a couple days ago and attempted to reproduce and couldn’t.<br>&gt;&gt; <br>&gt;&gt; Mark<br>&gt;&gt; <br>&gt;&gt;&gt; <br>&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>&gt;&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;         ^<br>&gt;&gt;&gt; &lt;stdin&gt;:329:34: note: scanning from here<br>&gt;&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;&gt;                                  ^<br>&gt;&gt;&gt; &lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br>&gt;&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;&gt;                                  ^<br>&gt;&gt;&gt; &lt;stdin&gt;:330:2: note: possible intended match here<br>&gt;&gt;&gt;  %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br>&gt;&gt;&gt;  ^<br>&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>&gt;&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;         ^<br>&gt;&gt;&gt; &lt;stdin&gt;:1625:67: note: scanning from here<br>&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;                                                                   ^<br>&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>&gt;&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;         ^<br>&gt;&gt;&gt; &lt;stdin&gt;:1842:88: note: scanning from here<br>&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;                                                                                        ^<br>&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>&gt;&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;         ^<br>&gt;&gt;&gt; &lt;stdin&gt;:2059:95: note: scanning from here<br>&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;                                                                                               ^<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; _______________________________________________<br>&gt;&gt;&gt; swift-dev mailing list<br>&gt;&gt;&gt; swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;<br>&gt;&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev &lt;https://lists.swift.org/mailman/listinfo/swift-dev&gt;<br>&gt;&gt; <br>&gt; <br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/d868e8c0/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/569ed436467cf145f3bbdd0d53fbe115?s=50"></div><header><strong>Flaky test - objc_nonnull_lie_hack</strong> from <string>Slava Pestov</string> &lt;spestov at apple.com&gt;<p>September  9, 2016 at 07:00:00pm</p></header><div class="content"><p>Oh, cool!<br></p><p>The change looks good to me. It’s a bit of a hack but less so than -enable-source-import. There are annoying differences in behavior between -enable-source-import and the real module loader, and this is made worse by the fact that so many tests use -enable-source-import so we’re effectively testing a debug-only code path. I’d like to just rip it out one day.<br></p><p>Slava<br></p><p>&gt; On Sep 9, 2016, at 5:18 PM, Jordan Rose &lt;jordan_rose at apple.com&gt; wrote:<br>&gt; <br>&gt; Dmitri tracked it down and has a fix for it, and then I had a complaint about his fix, and then I didn&#39;t get back to it. :-)<br>&gt; <br>&gt; https://github.com/apple/swift/pull/4622 &lt;https://github.com/apple/swift/pull/4622&gt;<br>&gt; <br>&gt; Jordan<br>&gt; <br>&gt; <br>&gt;&gt; On Sep 9, 2016, at 14:50, Slava Pestov via swift-dev &lt;swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;&gt; wrote:<br>&gt;&gt; <br>&gt;&gt; Running it in a loop on another machine doesn’t trigger it, so I’m thinking it might be a random variation in how the standard library is built?<br>&gt;&gt; <br>&gt;&gt;&gt; On Sep 9, 2016, at 2:49 PM, Mark Lacey &lt;mark.lacey at apple.com &lt;mailto:mark.lacey at apple.com&gt;&gt; wrote:<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; On Sep 9, 2016, at 2:45 PM, Slava Pestov via swift-dev &lt;swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;&gt; wrote:<br>&gt;&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; Hi all,<br>&gt;&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; Is anyone else seeing this? I haven’t seen it in CI, but for me this test fails at random, very rarely too — looks like something is non-deterministic in the optimizer?<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Yes, I hit this a couple days ago and attempted to reproduce and couldn’t.<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Mark<br>&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:30:9: error: expected string not found in input<br>&gt;&gt;&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[METATYPE]] : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;&gt;         ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:329:34: note: scanning from here<br>&gt;&gt;&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;&gt;&gt;                                  ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:329:34: note: with variable &quot;METATYPE&quot; equal to &quot;%0&quot;<br>&gt;&gt;&gt;&gt;  %0 = metatype $@thick Gizmo.Type, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:21, scope 54 // user: %1<br>&gt;&gt;&gt;&gt;                                  ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:330:2: note: possible intended match here<br>&gt;&gt;&gt;&gt;  %1 = class_method [volatile] %0 : $@thick Gizmo.Type, #Gizmo.nonNilGizmo!1.foreign : (Gizmo.Type) -&gt; () -&gt; Gizmo! , $@convention(objc_method) (@objc_metatype Gizmo.Type) -&gt; @autoreleased Optional&lt;Gizmo&gt;, loc &quot;SOURCE_DIR/test/SILGen/objc_nonnull_lie_hack.swift&quot;:36:27, scope 54 // user: %3<br>&gt;&gt;&gt;&gt;  ^<br>&gt;&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:44:9: error: expected string not found in input<br>&gt;&gt;&gt;&gt; // OPT: [[METHOD:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmo!1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;&gt;         ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:1625:67: note: scanning from here<br>&gt;&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack18callInstanceMethodFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;&gt;                                                                   ^<br>&gt;&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:58:9: error: expected string not found in input<br>&gt;&gt;&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.nonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;&gt;         ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:1842:88: note: scanning from here<br>&gt;&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack12loadPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;&gt;                                                                                        ^<br>&gt;&gt;&gt;&gt; /Users/slava/new/swift/test/SILGen/objc_nonnull_lie_hack.swift:71:9: error: expected string not found in input<br>&gt;&gt;&gt;&gt; // OPT: [[GETTER:%[0-9]+]] = class_method [volatile] [[OBJ:%[0-9]+]] : $Gizmo, #Gizmo.unownedNonNilGizmoProperty!getter.1.foreign : (Gizmo) -&gt; () -&gt; Gizmo , $@convention(objc_method) (Gizmo) -&gt; @autoreleased Gizmo<br>&gt;&gt;&gt;&gt;         ^<br>&gt;&gt;&gt;&gt; &lt;stdin&gt;:2059:95: note: scanning from here<br>&gt;&gt;&gt;&gt; sil hidden @_TTSf4g___TF21objc_nonnull_lie_hack19loadUnownedPropertyFT5gizmoCSo5Gizmo_GSqS0__ : $@convention(thin) (@guaranteed Gizmo) -&gt; @owned Optional&lt;Gizmo&gt; {<br>&gt;&gt;&gt;&gt;                                                                                               ^<br>&gt;&gt;&gt;&gt; <br>&gt;&gt;&gt;&gt; _______________________________________________<br>&gt;&gt;&gt;&gt; swift-dev mailing list<br>&gt;&gt;&gt;&gt; swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;<br>&gt;&gt;&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev &lt;https://lists.swift.org/mailman/listinfo/swift-dev&gt;<br>&gt;&gt;&gt; <br>&gt;&gt; <br>&gt;&gt; _______________________________________________<br>&gt;&gt; swift-dev mailing list<br>&gt;&gt; swift-dev at swift.org &lt;mailto:swift-dev at swift.org&gt;<br>&gt;&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br>&gt; <br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160909/054fd881/attachment.html&gt;<br></p></div></li></ul></li></ul></li></ul></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
