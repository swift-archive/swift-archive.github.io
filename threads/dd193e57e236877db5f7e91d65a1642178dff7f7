<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/e2303da56647c283b6d8e58d5831faca?s=50"></div><header><strong>Building Swift Package Manager on ARM</strong> from <string>Joseph Bell</string> &lt;joe at iachieved.it&gt;<p>December 28, 2015 at 09:00:00am</p></header><div class="content"><p>Howdy,<br></p><p>I&#39;m looking to getting the Swift Package Manager building on ARM systems<br>such as the BeagleBoard, and its now in the bootstrap stage, and bombs out<br>which what appears to be a linking error.  I know that<br>_TMaC18PackageDescription7Package<br>is defined in libPackageDescription.so but its not being picked up when<br>Package.swift is compiled.<br></p><p>That issue aside, what is the meaning of the &quot;driver-mode&quot; option to<br>swiftc, and why would one invoke swiftc with --driver-mode=swift?<br></p><p>swiftpm: using standard linker<br>+ /mnt/usbms/package-swift/swiftpm/Utilities/bootstrap<br>--swiftc=/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc<br>--sbt=/mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool<br>--build=/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7<br>--xctest=/mnt/usbms/package-swift/build/buildbot_linux/xctest-linux-armv7<br>bootstrap: note: building stage1:<br>/mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool<br>-f<br>/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/build.swift-build<br>bootstrap: note: building self-hosted &#39;swift-build&#39;: env<br>SWIFTC=/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc<br>SWIFT_BUILD_TOOL=/mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool<br>SWIFT_BUILD_PATH=/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7<br>SWIFTPM_EMBED_RPATH=$ORIGIN/../lib/swift/linux<br>/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/bin/swift-build<br>bootstrap: note: cwd will be set to /mnt/usbms/package-swift/swiftpm<br>LLVM ERROR: Program used external function<br>&#39;_TMaC18PackageDescription7Package&#39; which could not be resolved!<br>error: ExitStatus(1,<br>[&quot;/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc&quot;,<br>&quot;--driver-mode=swift&quot;, &quot;-I&quot;,<br>&quot;/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/lib/swift/pm&quot;,<br>&quot;-L&quot;,<br>&quot;/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/lib/swift/pm&quot;,<br>&quot;-lPackageDescription&quot;, &quot;/mnt/usbms/package-swift/swiftpm/Package.swift&quot;])<br>bootstrap: error: build failed with exit status 1<br>./swift/utils/build-script: command terminated with a non-zero exit status<br>1, aborting<br>./swift/utils/build-script: command terminated with a non-zero exit status<br>1, aborting<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-build-dev/attachments/20151228/dd19f7f7/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/5d9baa679148bd83458d11df12327ce0?s=50"></div><header><strong>Building Swift Package Manager on ARM</strong> from <string>Daniel Dunbar</string> &lt;daniel_dunbar at apple.com&gt;<p>January  2, 2016 at 09:00:00am</p></header><div class="content"><p>Hi Joseph,<br></p><p>The driver mode option tells swiftc to &quot;behave&quot; like &quot;swift&quot; (in this case, to act as an interpreter). The reason we use that option there is so that the bootstrap script can be passed just the path to `swiftc` and not need to be passed (or derive) the path to `swift`.<br></p><p>The failure you are seeing is most likely because `swift` is unable to load the dynamic library associated with the PackageDescription module (which is used to load the manifest files). The way that this is *supposed* to work is:<br> - The manifest files have `import PackageDescription`.<br> - swift finds that library via the -L arguments.<br> - swift will try and load the dynamic library associated with the module (but currently I don&#39;t believe it is an error if the `import` succeeds but the loading of the .so fails).<br> - swift JITs the code for the module, which then can dynamically link with the loaded library. This is what is failing in your case.<br></p><p>Unfortunately the way the LLVM JIT works the exact nature of the failure isn&#39;t obvious. What you can try to do is write a simple C program which dlopen()s the PackageDescription .so and see why it is failing (or if that is in fact the issue). It is also possible that some part of this pipeline isn&#39;t working properly for Swift on Linux/ARM.<br></p><p>HTH,<br> - Daniel<br></p><p>&gt; On Dec 28, 2015, at 7:00 AM, Joseph Bell via swift-build-dev &lt;swift-build-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; Howdy,<br>&gt; <br>&gt; I&#39;m looking to getting the Swift Package Manager building on ARM systems such as the BeagleBoard, and its now in the bootstrap stage, and bombs out which what appears to be a linking error.  I know that _TMaC18PackageDescription7Package is defined in libPackageDescription.so but its not being picked up when Package.swift is compiled.<br>&gt; <br>&gt; That issue aside, what is the meaning of the &quot;driver-mode&quot; option to swiftc, and why would one invoke swiftc with --driver-mode=swift?  <br>&gt; <br>&gt; swiftpm: using standard linker<br>&gt; + /mnt/usbms/package-swift/swiftpm/Utilities/bootstrap --swiftc=/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc --sbt=/mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool --build=/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7 --xctest=/mnt/usbms/package-swift/build/buildbot_linux/xctest-linux-armv7<br>&gt; bootstrap: note: building stage1: /mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool -f /mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/build.swift-build<br>&gt; bootstrap: note: building self-hosted &#39;swift-build&#39;: env SWIFTC=/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc SWIFT_BUILD_TOOL=/mnt/usbms/package-swift/build/buildbot_linux/llbuild-linux-armv7/bin/swift-build-tool SWIFT_BUILD_PATH=/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7 SWIFTPM_EMBED_RPATH=$ORIGIN/../lib/swift/linux /mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/bin/swift-build<br>&gt; bootstrap: note: cwd will be set to /mnt/usbms/package-swift/swiftpm<br>&gt; LLVM ERROR: Program used external function &#39;_TMaC18PackageDescription7Package&#39; which could not be resolved!<br>&gt; error: ExitStatus(1, [&quot;/mnt/usbms/package-swift/build/buildbot_linux/swift-linux-armv7/bin/swiftc&quot;, &quot;--driver-mode=swift&quot;, &quot;-I&quot;, &quot;/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/lib/swift/pm&quot;, &quot;-L&quot;, &quot;/mnt/usbms/package-swift/build/buildbot_linux/swiftpm-linux-armv7/.bootstrap/lib/swift/pm&quot;, &quot;-lPackageDescription&quot;, &quot;/mnt/usbms/package-swift/swiftpm/Package.swift&quot;])<br>&gt; bootstrap: error: build failed with exit status 1<br>&gt; ./swift/utils/build-script: command terminated with a non-zero exit status 1, aborting<br>&gt; ./swift/utils/build-script: command terminated with a non-zero exit status 1, aborting<br>&gt; <br>&gt; <br>&gt;  _______________________________________________<br>&gt; swift-build-dev mailing list<br>&gt; swift-build-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-build-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-build-dev/attachments/20160102/c4101d32/attachment.html&gt;<br></p></div></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
