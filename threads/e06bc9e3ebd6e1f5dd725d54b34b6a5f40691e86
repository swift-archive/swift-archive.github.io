<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css?vsn=d">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg?vsn=d" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/00851356c9f36ad35c35ab20df4a1cc7?s=50"></div><header><strong>Build failure on s390x</strong> from <string>Vivian Kong</string> &lt;vivkong at ca.ibm.com&gt;<p>August  9, 2016 at 10:00:00am</p></header><div class="content"><p>After apply this commit, the s390x build started to fail:<br>https://github.com/apple/swift/commit/dc88e51321e0a4f281406c265a91308a06aa517f<br></p><p><br>The commit added 2 new functions in<br>stdlib/public/SwiftShims/RuntimeStubs.h.  They are used in<br>stdlib/public/stubs/CommandLine.cpp with SWIFT_CC(swift) macro.  Since we<br>use the LLVM&#39;s intrinsic &quot;swiftcall&quot; on s390x, this caused a build error.<br>To fix it we added the SWIFT_CC(swift) macro and #include<br>&quot;swift/Runtime/Config.h&quot; to RuntimeStubs.h.  We then ran into this build<br>error:<br></p><p>&lt;module-includes&gt;:9:10: note: in file included from &lt;module-includes&gt;:9:<br>#include &quot;RuntimeStubs.h&quot;<br>         ^<br>/localbox/vivkong/swift/build/Ninja-RelWithDebInfoAssert/swift-linux-s390x/./lib/swift/shims/RuntimeStubs.h:23:10:<br> error:<br>&#39;swift/Runtime/Config.h&#39; file not found<br>#include &quot;swift/Runtime/Config.h&quot;<br></p><p><br>I tried modifying stdlib/public/SwiftShims/CMakeLists.txt with<br></p><p>include_directories(<br>  ${CMAKE_SOURCE_DIR}/include<br>  )<br></p><p>But that didn&#39;t seem to work.  Any suggestions on how to fix this?<br></p><p>Thanks for your help!<br></p><p>Regards,<br></p><p>Vivian Kong<br>Software Developer<br>IBM Canada Toronto Lab<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160809/e06b1e86/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/c4fe988326eed161b989d0c5521cb105?s=50"></div><header><strong>Build failure on s390x</strong> from <string>Jordan Rose</string> &lt;jordan_rose at apple.com&gt;<p>August  9, 2016 at 02:00:00pm</p></header><div class="content"><p>Hi, Vivian. RuntimeStubs.h (along with the rest of SwiftShims) is a header that gets shipped with the Swift library, so it can’t refer to anything outside of its folder. Since we don’t yet have a good way to annotate things as using the Swift calling convention in the SwiftShims headers, we should probably not be using the Swift calling convention there (at least for now). Can you write up a pull request removing the SWIFT_CC annotation from the functions declared in RuntimeStubs.h?<br></p><p>(I’m a little concerned that Clang didn’t tell us that the calling convention isn’t consistent across declarations, but that’s a separate issue. Maybe the lack of an annotation isn’t strong enough information to produce a warning.)<br></p><p>Thanks,<br>Jordan<br></p><p><br>&gt; On Aug 9, 2016, at 07:42, Vivian Kong via swift-dev &lt;swift-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; After apply this commit, the s390x build started to fail:<br>&gt; https://github.com/apple/swift/commit/dc88e51321e0a4f281406c265a91308a06aa517f &lt;https://github.com/apple/swift/commit/dc88e51321e0a4f281406c265a91308a06aa517f&gt;<br>&gt; <br>&gt; The commit added 2 new functions in stdlib/public/SwiftShims/RuntimeStubs.h. They are used in stdlib/public/stubs/CommandLine.cpp with SWIFT_CC(swift) macro. Since we use the LLVM&#39;s intrinsic &quot;swiftcall&quot; on s390x, this caused a build error. To fix it we added the SWIFT_CC(swift) macro and #include &quot;swift/Runtime/Config.h&quot; to RuntimeStubs.h. We then ran into this build error:<br>&gt; <br>&gt; &lt;module-includes&gt;:9:10: note: in file included from &lt;module-includes&gt;:9:<br>&gt; #include &quot;RuntimeStubs.h&quot;<br>&gt; ^<br>&gt; /localbox/vivkong/swift/build/Ninja-RelWithDebInfoAssert/swift-linux-s390x/./lib/swift/shims/RuntimeStubs.h:23:10: error: &#39;swift/Runtime/Config.h&#39; file not found<br>&gt; #include &quot;swift/Runtime/Config.h&quot;<br>&gt; <br>&gt; <br>&gt; I tried modifying stdlib/public/SwiftShims/CMakeLists.txt with<br>&gt; <br>&gt; include_directories(<br>&gt; ${CMAKE_SOURCE_DIR}/include<br>&gt; )<br>&gt; <br>&gt; But that didn&#39;t seem to work. Any suggestions on how to fix this?<br>&gt; <br>&gt; Thanks for your help!<br>&gt; <br>&gt; Regards,<br>&gt; <br>&gt; Vivian Kong<br>&gt; Software Developer<br>&gt; IBM Canada Toronto Lab<br>&gt; _______________________________________________<br>&gt; swift-dev mailing list<br>&gt; swift-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160809/3fbea78f/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/00851356c9f36ad35c35ab20df4a1cc7?s=50"></div><header><strong>Build failure on s390x</strong> from <string>Vivian Kong</string> &lt;vivkong at ca.ibm.com&gt;<p>August 10, 2016 at 08:00:00am</p></header><div class="content"><p>Thanks Jordan!  I&#39;ll create a pull request.<br></p><p>Regards,<br></p><p>Vivian Kong<br>Software Developer<br>IBM Canada Toronto Lab<br></p><p><br></p><p>From:	Jordan Rose &lt;jordan_rose at apple.com&gt;<br>To:	Vivian Kong/Toronto/IBM at IBMCA<br>Cc:	swift-dev &lt;swift-dev at swift.org&gt;, Robert Widmann<br>            &lt;rwidmann at apple.com&gt;<br>Date:	2016/08/09 05:08 PM<br>Subject:	Re: [swift-dev] Build failure on s390x<br>Sent by:	jordan_rose at apple.com<br></p><p><br></p><p>Hi, Vivian. RuntimeStubs.h (along with the rest of SwiftShims) is a header<br>that gets shipped with the Swift library, so it can’t refer to anything<br>outside of its folder. Since we don’t yet have a good way to annotate<br>things as using the Swift calling convention in the SwiftShims headers, we<br>should probably not be using the Swift calling convention there (at least<br>for now). Can you write up a pull request removing the SWIFT_CC annotation<br>from the functions declared in RuntimeStubs.h?<br></p><p>(I’m a little concerned that Clang didn’t tell us that the calling<br>convention isn’t consistent across declarations, but that’s a separate<br>issue. Maybe the lack of an annotation isn’t strong enough information to<br>produce a warning.)<br></p><p>Thanks,<br>Jordan<br></p><p><br>      On Aug 9, 2016, at 07:42, Vivian Kong via swift-dev &lt;<br>      swift-dev at swift.org&gt; wrote:<br></p><p><br></p><p>      After apply this commit, the s390x build started to fail:<br>      https://github.com/apple/swift/commit/dc88e51321e0a4f281406c265a91308a06aa517f<br></p><p><br>      The commit added 2 new functions in<br>      stdlib/public/SwiftShims/RuntimeStubs.h. They are used in<br>      stdlib/public/stubs/CommandLine.cpp with SWIFT_CC(swift) macro. Since<br>      we use the LLVM&#39;s intrinsic &quot;swiftcall&quot; on s390x, this caused a build<br>      error. To fix it we added the SWIFT_CC(swift) macro and #include<br>      &quot;swift/Runtime/Config.h&quot; to RuntimeStubs.h. We then ran into this<br>      build error:<br></p><p>      &lt;module-includes&gt;:9:10: note: in file included from<br>      &lt;module-includes&gt;:9:<br>      #include &quot;RuntimeStubs.h&quot;<br>      ^<br>      /localbox/vivkong/swift/build/Ninja-RelWithDebInfoAssert/swift-linux-s390x/./lib/swift/shims/RuntimeStubs.h:23:10:<br> error:<br>      &#39;swift/Runtime/Config.h&#39; file not found<br>      #include &quot;swift/Runtime/Config.h&quot;<br></p><p><br>      I tried modifying stdlib/public/SwiftShims/CMakeLists.txt with<br></p><p>      include_directories(<br>      ${CMAKE_SOURCE_DIR}/include<br>      )<br></p><p>      But that didn&#39;t seem to work. Any suggestions on how to fix this?<br></p><p>      Thanks for your help!<br></p><p>      Regards,<br></p><p>      Vivian Kong<br>      Software Developer<br>      IBM Canada Toronto Lab<br></p><p><br>      _______________________________________________<br>      swift-dev mailing list<br>      swift-dev at swift.org<br>      https://lists.swift.org/mailman/listinfo/swift-dev<br></p><p><br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160810/6519c9fe/attachment.html&gt;<br>-------------- next part --------------<br>A non-text attachment was scrubbed...<br>Name: graycol.gif<br>Type: image/gif<br>Size: 105 bytes<br>Desc: not available<br>URL: &lt;https://lists.swift.org/pipermail/swift-dev/attachments/20160810/6519c9fe/attachment.gif&gt;<br></p></div></li></ul></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js?vsn=d"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
