<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Swift Mailing List Archive</title>
    <link rel="stylesheet" href="/css/app-13f065ae5e595562a5022c544e3b976c.css?vsn=d">
  </head>

  <body>
    <div class="container">
      <header class="header">
        <img src="/images/swift-d0237fc716ba0932a940049990beba1b.svg?vsn=d" height="70">
      </header>

      <p class="alert alert-info" role="alert"></p>
      <p class="alert alert-danger" role="alert"></p>

    </div> <!-- /container -->
    <main role="main">
<div class="comment-wrapper"><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/83a7afc7b5b71bf588de2450e7a04983?s=50"></div><header><strong>swift test undefined reference error</strong> from <string>G J</string> &lt;fishpesce at gmail.com&gt;<p>May 24, 2016 at 10:00:00am</p></header><div class="content"><p>I am attempting to use unit tests on a swift project in linux with<br>Swift DEVELOPMENT.SNAPSHOT.2016.05.09.a.<br></p><p>The executable is built in a module named WindFarmIRR with directory<br>structure:<br></p><p>Package.swift<br>Sources (D)<br>      main.swift<br>      irr.swift<br>      stringHelpers.swift<br>Tests (D)<br>      LinuxMain.swift<br>      WindFarmIRRTests (D)<br>             WindFarmIRRTests.swift<br></p><p><br>my test file, WindFarmIRRTests.swift, includes a line to import the<br>WindFarmIRR module:    @testable import WindFarmIRR.<br></p><p>I am able to build the module successfully.   When I run swift test,<br>however, the build fails with an &#39;undefined reference to&#39; error.   Sample<br>output is:<br></p><p>swift test<br>Compile Swift Module &#39;WindFarmIRRTestsTestSuite&#39; (1 sources)<br>Linking .build/debug/WindFarmIRRTests.xctest<br>/home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug/WindFarmIRRTestsTestSuite.build/WindFarmIRRTests.swift.o:<br>In function<br>`_TFC25WindFarmIRRTestsTestSuite16WindFarmIRRTests26testCashFlowStructCashFlowfT_T_&#39;:<br>/home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/Tests/WindFarmIRRTests/WindFarmIRRTests.swift:19:<br>undefined reference to `_TFV11WindFarmIRR8CashFlowCfT_S0_&#39;<br>/home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug/WindFarmIRRTestsTestSuite.build/WindFarmIRRTests.swift.o:<br>In function<br>`_TFFC25WindFarmIRRTestsTestSuite16WindFarmIRRTests26testCashFlowStructCashFlowFT_T_u_KzT_GSqSd_&#39;:<br>/home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/Tests/WindFarmIRRTests/WindFarmIRRTests.swift:26:<br>undefined reference to `_TFV11WindFarmIRR8CashFlow8cashFlowfT_Sd&#39;<br>clang-3.8: error: linker command failed with exit code 1 (use -v to see<br>invocation)<br>&lt;unknown&gt;:0: error: link command failed with exit code 1 (use -v to see<br>invocation)<br>&lt;unknown&gt;:0: error: build had 1 command failures<br>error: exit(1): /usr/bin/swift-build-tool -f<br>/home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug.yaml<br>test<br></p><p>Text of LinuxMain.swift is:<br>------------------<br>import XCTest<br></p><p>@testable import WindFarmIRRTestsTestSuite<br></p><p>XCTMain([<br>    testCase(WindFarmIRRTests.allTests)<br>])<br>-------------------<br></p><p>Text of WindFarmIRRTests.swift is:<br>--------------------<br>#if os(Linux)<br>extension WindFarmIRRTests {<br>     static var allTests : [(String, (WindFarmIRRTests) -&gt; () throws -&gt;<br>Void)] {<br>        return [<br>            (&quot;testCashFlowStructCashFlow&quot;, testCashFlowStructCashFlow)<br>        ]<br>    }<br>}<br>#endif<br></p><p>import XCTest<br>@testable import WindFarmIRR<br></p><p>class WindFarmIRRTests: XCTestCase {<br></p><p><br>    func testCashFlowStructCashFlow(){<br></p><p>        var cf = CashFlow()<br>        cf.electricitySaleIncome = 100<br>        cf.capitalCosts = 0<br>        cf.oAndMCosts = 0<br>        cf.transmissionCosts = 0<br></p><p><br>        XCTAssertEqual(cf.cashFlow(),100)<br></p><p><br>    }<br></p><p>}<br>---------------------------<br></p><p><br>The problem appears to be that the linker cannot find the executable module<br>to resolve the relevant symbols.<br></p><p>I would appreciate suggestions on what I am missing in the setup.<br></p><p><br>Thanks<br>-------------- next part --------------<br>An HTML attachment was scrubbed...<br>URL: &lt;https://lists.swift.org/pipermail/swift-build-dev/attachments/20160524/996fa30b/attachment.html&gt;<br></p></div><ul class="comments"><li class="comment"><div class="avatar"><img src="https://www.gravatar.com/avatar/5d9baa679148bd83458d11df12327ce0?s=50"></div><header><strong>swift test undefined reference error</strong> from <string>Daniel Dunbar</string> &lt;daniel_dunbar at apple.com&gt;<p>May 24, 2016 at 08:00:00am</p></header><div class="content"><p>Currently your Tests subdirectory needs to be named WindFarmIRR, which is not something we do a good job of diagnosing. I filed:<br>  https://bugs.swift.org/browse/SR-1607<br>to track fixing this.<br></p><p> - Daniel<br></p><p>&gt; On May 24, 2016, at 7:05 AM, G J via swift-build-dev &lt;swift-build-dev at swift.org&gt; wrote:<br>&gt; <br>&gt; I am attempting to use unit tests on a swift project in linux with Swift DEVELOPMENT.SNAPSHOT.2016.05.09.a.<br>&gt; <br>&gt; The executable is built in a module named WindFarmIRR with directory structure:<br>&gt; <br>&gt; Package.swift<br>&gt; Sources (D)<br>&gt;       main.swift<br>&gt;       irr.swift<br>&gt;       stringHelpers.swift<br>&gt; Tests (D)<br>&gt;       LinuxMain.swift<br>&gt;       WindFarmIRRTests (D)<br>&gt;              WindFarmIRRTests.swift<br>&gt; <br>&gt; <br>&gt; my test file, WindFarmIRRTests.swift, includes a line to import the WindFarmIRR module:    @testable import WindFarmIRR.<br>&gt; <br>&gt; I am able to build the module successfully.   When I run swift test, however, the build fails with an &#39;undefined reference to&#39; error.   Sample output is:   <br>&gt; <br>&gt; swift test<br>&gt; Compile Swift Module &#39;WindFarmIRRTestsTestSuite&#39; (1 sources)<br>&gt; Linking .build/debug/WindFarmIRRTests.xctest<br>&gt; /home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug/WindFarmIRRTestsTestSuite.build/WindFarmIRRTests.swift.o: In function `_TFC25WindFarmIRRTestsTestSuite16WindFarmIRRTests26testCashFlowStructCashFlowfT_T_&#39;:<br>&gt; /home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/Tests/WindFarmIRRTests/WindFarmIRRTests.swift:19: undefined reference to `_TFV11WindFarmIRR8CashFlowCfT_S0_&#39;<br>&gt; /home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug/WindFarmIRRTestsTestSuite.build/WindFarmIRRTests.swift.o: In function `_TFFC25WindFarmIRRTestsTestSuite16WindFarmIRRTests26testCashFlowStructCashFlowFT_T_u_KzT_GSqSd_&#39;:<br>&gt; /home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/Tests/WindFarmIRRTests/WindFarmIRRTests.swift:26: undefined reference to `_TFV11WindFarmIRR8CashFlow8cashFlowfT_Sd&#39;<br>&gt; clang-3.8: error: linker command failed with exit code 1 (use -v to see invocation)<br>&gt; &lt;unknown&gt;:0: error: link command failed with exit code 1 (use -v to see invocation)<br>&gt; &lt;unknown&gt;:0: error: build had 1 command failures<br>&gt; error: exit(1): /usr/bin/swift-build-tool -f /home/greg/Dropbox/common_files/Programming/Swift/commercial/WindFutureLLC/WindFarmIRR/linux/WindFarmIRR-SwiftPM/.build/debug.yaml test<br>&gt; <br>&gt; Text of LinuxMain.swift is:<br>&gt; ------------------<br>&gt; import XCTest<br>&gt; <br>&gt; @testable import WindFarmIRRTestsTestSuite<br>&gt; <br>&gt; XCTMain([<br>&gt;     testCase(WindFarmIRRTests.allTests)<br>&gt; ])<br>&gt; -------------------<br>&gt; <br>&gt; Text of WindFarmIRRTests.swift is:<br>&gt; --------------------<br>&gt; #if os(Linux)<br>&gt; extension WindFarmIRRTests {<br>&gt;      static var allTests : [(String, (WindFarmIRRTests) -&gt; () throws -&gt; Void)] {<br>&gt;         return [<br>&gt;             (&quot;testCashFlowStructCashFlow&quot;, testCashFlowStructCashFlow)<br>&gt;         ]<br>&gt;     }<br>&gt; }<br>&gt; #endif<br>&gt; <br>&gt; import XCTest<br>&gt; @testable import WindFarmIRR<br>&gt; <br>&gt; class WindFarmIRRTests: XCTestCase {<br>&gt; <br>&gt;         <br>&gt;     func testCashFlowStructCashFlow(){<br>&gt; <br>&gt;         var cf = CashFlow()<br>&gt;         cf.electricitySaleIncome = 100<br>&gt;         cf.capitalCosts = 0<br>&gt;         cf.oAndMCosts = 0<br>&gt;         cf.transmissionCosts = 0<br>&gt; <br>&gt;         <br>&gt;         XCTAssertEqual(cf.cashFlow(),100)<br>&gt;         <br>&gt;         <br>&gt;     }<br>&gt; <br>&gt; }<br>&gt; ---------------------------<br>&gt; <br>&gt; <br>&gt; The problem appears to be that the linker cannot find the executable module to resolve the relevant symbols.<br>&gt; <br>&gt; I would appreciate suggestions on what I am missing in the setup.<br>&gt; <br>&gt; <br>&gt; Thanks<br>&gt; <br>&gt; _______________________________________________<br>&gt; swift-build-dev mailing list<br>&gt; swift-build-dev at swift.org<br>&gt; https://lists.swift.org/mailman/listinfo/swift-build-dev<br></p></div></li></ul></li></ul></div>    </main>
    <script src="/js/app-c283ee129de63ad743722e9511e67a5d.js?vsn=d"></script>
  </body>
  <footer>
    <p>Swift and the Swift logo are trademarks of Apple Inc.</p>
  </footer>
</html>
